; IR code
; PUSH
; JSR FUNC_id_main_L
; HALT
; LABEL FUNC_id_factorial_L
; LINK 3
; STOREI 1 !T0
;NE $2 !T0 label1
;STOREI 1 !T1
; STOREI !T1 $3
; UNLINK
; RET
;JUMP label2
;LABEL label1
; PUSH (return value)
;STOREI 1 !T2
;SUBI $2 !T2 !T3
; PUSH !T3
; JSR FUNC_id_factorial_L
; POP
; POP !T4
; STOREI !T4 $-2
;MULTI $-2 $2 !T5
; STOREI !T5 $-1
;LABEL label2
; STOREI $-1 $3
; UNLINK
; RET
; LABEL FUNC_id_main_L
; LINK 3
;WRITES input
; READI $-1
; STOREI 1 !T6
;NE $-1 !T6 label3
; STOREI 1 !T7
; STOREI !T7 $-2
;JUMP label4
;LABEL label3
; STOREI 1 !T8
;LE $-1 !T8 label5
; PUSH (return value)
; PUSH $-1
; JSR FUNC_id_factorial_L
; POP
; POP !T9
; STOREI !T9 $-2
;JUMP label6
;LABEL label5
; STOREI 0 !T10
; STOREI !T10 $-2
;LABEL label6
;LABEL label4
; WRITEI $-2
;WRITES eol
;STOREI 0 !T11
; STOREI !T11 $3
; UNLINK
; RET
;tiny code
str input "Please enter an integer number: "
str eol "\n"
label factorial
var ret
var tret
move 1 r-1
cmpi a r-1
jne label1
jmp label2
label label1
move 1 r1
move a r2
subi r1 r2
move tret r4
muli a r4
move r4 ret
label label2
label main
var num
var result
sys writes input
sys readi num
move 1 r5
cmpi num r5
jne label3
move 1 r6
move r6 result
jmp label4
label label3
move 1 r7
cmpi num r7
jle label5
jmp label6
label label5
move 0 r9
move r9 result
label label6
label label4
sys writei result
sys writes eol
sys halt
